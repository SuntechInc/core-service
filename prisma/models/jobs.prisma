model JobTitle {
  id         String   @id @default(cuid())                @map("id_job_title")
  companyId  String  @map("id_company")                 
  name       String   @map("job_title_name")
  code       String?  @map("job_title_code")
  createdAt  DateTime @default(now())                     @map("created_at")
  versions   JobTitleVersion[]

  // Relações
  branch     Branch   @relation(fields: [branchId], references: [id])
  branchId   String   @map("id_branch")

  @@unique([companyId, name])
  @@map("job_titles")
}

model JobTitleVersion {
  id            String   @id @default(cuid())             @map("id_job_title_version")
  jobTitleId    String   @map("id_job_title")
  versionNumber Int      @map("version_number")
  effectiveFrom DateTime @map("effective_from")
  salaryMin     Decimal? @map("salary_min")
  salaryMax     Decimal? @map("salary_max")
  description   String?

  jobTitle      JobTitle @relation(fields: [jobTitleId], references: [id])
  employees     Employee[]
  jobTitleHistory EmployeeJobTitleHistory[]

  @@unique([jobTitleId, versionNumber])
  @@map("job_title_versions")
}

model EmployeeJobTitleHistory {
  employeeId          String  @map("id_employee")
  jobTitleVersionId   String  @map("id_job_title_version")
  assignedAt          DateTime @default(now())            @map("assigned_at")
  removedAt           DateTime?                           @map("removed_at")

  employee            Employee        @relation(fields: [employeeId], references: [id])
  jobTitleVersion     JobTitleVersion @relation(fields: [jobTitleVersionId], references: [id])

  @@id([employeeId, jobTitleVersionId, assignedAt])
  @@map("employee_job_title_history")
}
